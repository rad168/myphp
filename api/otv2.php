<?php
/*
http://127.0.0.1/TVOD/yfyts.php?id=1
http://127.0.0.1/TVOD/yfyts.php?ml=13&id=1
*/
date_default_timezone_set('PRC');
$n = array(
'1'=>'4403',//CCTV1综合
'2'=>'4403',//CCTV2财经
'3'=>'4309',//CCTV3综艺
'4'=>'4309',//CCTV4中文国际
'5'=>'4403',//CCTV5体育
'6'=>'4403',//CCTV6电影
'7'=>'4309',//CCTV7国防军事
'8'=>'4403',//CCTV8电视剧
'9'=>'4309',//CCTV9纪录
'10'=>'4309',//CCTV10科教
'11'=>'4309',//CCTV12社会与法
'12'=>'4309',//CCTV14少儿
'13'=>'4309',//CCTV5+体育赛事
'14'=>'4403',//CGTN纪录
'15'=>'4309',//CGTN
'16'=>'4403',//广东卫视
'17'=>'4403',//深圳卫视
'18'=>'4403',//江苏卫视
'19'=>'4403',//浙江卫视
'20'=>'4403',//吉林卫视
'21'=>'4403',//湖北卫视
'22'=>'4403',//江西卫视
'23'=>'4403',//安徽卫视
'24'=>'4403',//北京卫视
'25'=>'4403',//湖南卫视
'26'=>'4403',//东方卫视
'27'=>'4309',//黑龙江卫视
'28'=>'4403',//天津卫视
'29'=>'1301',//山东卫视
'30'=>'4309',//贵州卫视
'31'=>'4403',//四川卫视
'32'=>'4403',//辽宁卫视
'33'=>'4403',//CETV1中教1台
'34'=>'4403',//广东体育
'37'=>'4403',//蛇口电视台
'38'=>'4403',//CETV4中教4台
'39'=>'4403',//CCTV13新闻
'40'=>'4403',//CCTV15音乐
'41'=>'4403',//CCTV11戏曲
'42'=>'4403',//深圳宜和购物
'45'=>'4403',//广东民生
'46'=>'4403',//深圳都市
'47'=>'4403',//深圳电视剧
'48'=>'4403',//深圳财经生活
'49'=>'4403',//深圳娱乐
'50'=>'4403',//深圳体育健康
'51'=>'4403',//深圳少儿
'52'=>'4403',//深圳公共
'53'=>'4403',//优漫卡通
'54'=>'4309',//山西卫视
'55'=>'1301',//陕西卫视
'56'=>'4309',//重庆卫视
'57'=>'4309',//甘肃卫视
'58'=>'4403',//大湾区卫视
'59'=>'4309',//广西卫视
'60'=>'4309',//青海卫视
'61'=>'4309',//云南卫视
'62'=>'1301',//海南卫视
'63'=>'4403',//广东少儿
'64'=>'4403',//新疆卫视
'65'=>'4403',//广东珠江
'66'=>'4309',//西藏卫视
'67'=>'4309',//兵团卫视
'69'=>'4309',//宁夏卫视
'78'=>'4309',//河南卫视
'79'=>'1301',//河北卫视
'80'=>'4309',//东南卫视
'81'=>'4309',//金鹰卡通
'90'=>'4309',//CCTV17农业农村
'93'=>'4309',//内蒙古卫视
'116'=>'1301',//CCTV16奥林匹克
'11001'=>'1301',//北京纪实科教
'11003'=>'1301',//卡酷少儿
'11004'=>'1301',//车迷频道
'11005'=>'1301',//环球旅游
'11006'=>'1301',//中国天气
'11007'=>'1301',//优优宝贝
'11008'=>'1301',//聚鲨环球精选
'11009'=>'1301',//书画频道
'11011'=>'1301',//央广购物
'12001'=>'1301',//河北三佳购物
'13001'=>'1301',//河南梨园
'13002'=>'1301',//河北杂技
'13003'=>'1301',//河北经济生活
'13004'=>'1301',//河北农民
'13005'=>'1301',//河北都市
'13006'=>'1301',//河北影视剧
'13007'=>'1301',//河北少儿科教
'13008'=>'1301',//河北公共
'13009'=>'1301',//邯郸新闻综合
'13010'=>'1301',//河北收视指南
'13011'=>'1301',//石家庄娱乐
'13012'=>'1301',//石家庄生活
'13013'=>'1301',//石家庄都市
'13014'=>'1301',//石家庄新闻综合
'13110'=>'1301',//唐山新闻综合
'13111'=>'1301',//唐山生活服务
'13112'=>'1301',//唐山影视
'13113'=>'1301',//唐山公共
'21001'=>'1301',//家庭理财
'22002'=>'1301',//家有购物
'22030'=>'1301',//北京纪实科教
'32010'=>'1301',//聚鲨环球精选2
'37001'=>'1301',//山东教育卫视
'37002'=>'1301',//中华美食
'41101'=>'1301',//河南都市
'41102'=>'1301',//河南民生
'41103'=>'1301',//河南法治
'41104'=>'1301',//河南电视剧
'41105'=>'1301',//河南新闻
'41106'=>'1301',//河南公共
'41107'=>'1301',//河南乡村
'41108'=>'1301',//河南睛彩中原
'41109'=>'1301',//河南移动戏曲
'41110'=>'1301',//河南功夫
'41111'=>'1301',//河南收藏天下
'41112'=>'1301',//郑州新闻综合
'41113'=>'1301',//周口新闻综合
'41114'=>'1301',//开封新闻综合
'41115'=>'1301',//洛阳新闻综合
'41116'=>'1301',//平顶山新闻综合
'41117'=>'1301',//安阳新闻综合
'41118'=>'1301',//鹤壁新闻综合
'41119'=>'1301',//新乡新闻综合
'41120'=>'1301',//焦作新闻综合
'41121'=>'1301',//濮阳新闻综合
'41122'=>'1301',//许昌综合
'41123'=>'1301',//漯河新闻综合
'41124'=>'1301',//三门峡新闻综合
'41125'=>'1301',//商丘新闻综合
'41126'=>'1301',//驻马店新闻综合
'41127'=>'1301',//南阳新闻综合
'41128'=>'1301',//信阳新闻综合
'41129'=>'1301',//济源1套
'41130'=>'1301',//长城铝综合
'41133'=>'1301',//嘉佳卡通
'41135'=>'1301',//东方财经
'41136'=>'1301',//兰铁TV
'41137'=>'1301',//人民铁道
'43021'=>'4309',//湖南教育
'43024'=>'4309',//湖南经视
'43025'=>'4309',//金鹰卡通
'43027'=>'4309',//湖南娱乐
'43028'=>'4309',//湖南都市
'43029'=>'4309',//湖南电影
'43030'=>'4309',//湖南电视剧
'43032'=>'4403',//快乐购
'43036'=>'1301',//四海钓鱼
'43038'=>'1301',//劲爆体育
'43039'=>'4309',//欢笑剧场
'43040'=>'4309',//乐游
'43041'=>'1301',//游戏风云
'43043'=>'4309',//生活时尚
'43045'=>'4309',//动漫秀场
'43063'=>'4309',//CHC高清电影
'43080'=>'4309',//湖南爱晚
'43082'=>'4309',//新视觉
'43083'=>'4309',//魅力足球
'43084'=>'4309',//劲爆体育
'43085'=>'4309',//都市剧场
'43087'=>'4309',//金鹰纪实
'43088'=>'4309',//益阳新闻综合
'43089'=>'4309',//益阳教育
'43090'=>'4309',//益阳公共
'43094'=>'4309',//湖南都市
'43098'=>'4309',//湖南电影
'52002'=>'1301',//凤凰资讯
'52003'=>'1301',//凤凰中文
'62001'=>'1301',//证券服务
);

$id=$_GET["id"];$cdn=$n[$id];$cdn1="hs";	
if ($_GET['ml']){$ml=$_GET['ml'];}else{$ml='23';}
$ip='1.62.64.92/645c6e6320d051d49b446bac57d65143.v.smtcdns.net';
$url='http://'.$ip.'/'.$cdn.'-tx.otvstream.otvcloud.com/otv/skcc/live/channel'.$id.'/'.$ml.'00.m3u8';
$http='http://'.$cdn.'-'.$cdn1.'.otvstream.otvcloud.com/otv/skcc/review/channel'.$id.'/';
$contents=get_data($url);
$contents=str_replace("\r",'',$contents);
$contents=preg_replace("/#EXTID.*\n/","",$contents);
$contents=str_replace("\n".$ml.'00/',"\n".$http.$ml.'00/',$contents);
header('Content-Type: application/vnd.apple.mpegurl');
echo $contents;exit;

function get_data($url)
{
$ch=curl_init();
$User_Agent='Mozilla/5.0 (Linux; U; Android 4.0.4; zh-cn; HTC T528w Build/IMM76D) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410  Safari/533.1';
$timeout=5;
curl_setopt($ch,CURLOPT_URL,$url);
curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch,CURLOPT_HEADER,0);
curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,$timeout);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION,1);
curl_setopt($ch,CURLOPT_USERAGENT,$User_Agent);
$chr=curl_exec($ch);
curl_close($ch);
return $chr;
}
?>
